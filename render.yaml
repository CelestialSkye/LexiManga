services:
  # Backend API Server
  - type: web
    name: vocabularymanga-backend
    env: node
    plan: free
    buildCommand: cd server && npm install && npm run build
    startCommand: cd server && npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000
      # IMPORTANT: Set these via Render Dashboard Environment tab:
      # - GEMINI_API_KEY (from your .env file)
      # - VITE_RECAPTCHA_SECRET_KEY (from your .env file)
      # - FIREBASE_SERVICE_ACCOUNT_JSON (Download from Firebase Console > Service Accounts)
      # - VITE_FIREBASE_PROJECT_ID (vocabularymanga)

  # Frontend Static Site
  - type: web
    name: leximanga-frontend
    env: static
    plan: free
    buildCommand: npm install && npm run build
    staticPublishPath: ./dist
    redirects:
      - source: /*
        destination: /index.html
        type: rewrite
    envVars:
      - key: VITE_BACKEND_URL
        value: https://vocabularymanga-backend.onrender.com
      - key: VITE_FIREBASE_API_KEY
        value: AIzaSyBxHZ8mo0hYCzwn1vdmuNbvqAIZKJo_CAM
      - key: VITE_FIREBASE_AUTH_DOMAIN
        value: vocabularymanga.firebaseapp.com
      - key: VITE_FIREBASE_PROJECT_ID
        value: vocabularymanga
      - key: VITE_FIREBASE_STORAGE_BUCKET
        value: vocabularymanga-storage
      - key: VITE_FIREBASE_MESSAGING_SENDER_ID
        value: 640532718693
      - key: VITE_FIREBASE_APP_ID
        value: 1:640532718693:web:1bf8682d59afe9ec41928c
      - key: VITE_FIREBASE_MEASUREMENT_ID
        value: G-NMWY60C1Z2
      - key: VITE_RECAPTCHA_SITE_KEY
        value: 6LetrAksAAAAAByDp5Yg_15IYkcE5YiPj28kp9HT
